
<div class="row">
  <div style="display:none" id="progress-bar" class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading" id="job_messages">
        <h2><i class="fa fa-align-justify"></i><span class="break"></span>Message</h2>
      </div>
      <div class="panel-body">
        <div class="progress">
          <div id="job-progress" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
            0%
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-3">
    <div class="panel panel-default">
      <div class="panel-body">
        <dl>
            <dt><i class="fa fa-user"></i> Author:</dt>
            <dd><%= @jem.author %></dd>

            <dt><i class="fa fa-inbox"></i> Email:</dt>
            <dd><%= @jem.email %></dd>

            <dt><i class="fa fa-home"></i> Homepage:</dt>
            <dd><%= @jem.homepage %></dd>

            <dt><i class="fa fa-align-left"></i> Name:</dt>
            <dd><%= @jem.name %></dd>

            <dt><i class="fa fa-github"></i> Original JS Github:</dt>
            <% if URI.parse(@jem.github).scheme == nil %>
              <dd><%= link_to @jem.github.to_s, "http://" + @jem.github.to_s %></dd>
            <% else %>
              <dd><%= link_to @jem.github, @jem.github.to_s %></dd>
            <% end %>

            <dt><i class="fa fa-arrow-circle-up"></i> Version:</dt>
            <dd><%= @jem.version_number %></dd>

            <dt><i class="fa fa-align-justify"></i> Description:</dt>
            <dd><%= @jem.description %></dd>

            <dt><i class="fa fa-clock-o"></i> Created:</dt>
            <dd><%= @jem.created_at %></dd>

            <dt><i class="fa fa-arrow-up"></i> Update:</dt>
            <dd><%= @jem.updated_at %></dd>

            <div id="rubygem_link_container" class="left-panel hidden">
              <dt><i class="fa fa-arrow-up"></i> Rubygems:</dt>
              <dd id="rubygem_link"><%= @jem.rubygem_link %></dd>
            </div>

            <div id="gem_repo" class="left-panel hidden">
              <dt><i class="fa fa-arrow-up"></i> Gem Repository:</dt>
              <dd><%= @jem.gem_repo %></dd>
            </div>

            <div class="hidden" id="jem_id"><%= @jem.id %></div>

        </dl>
      </div>
    </div>
  </div>


  <div class="col-md-9">
  <%# @jem.log_rubygems %>
  <%#= Gems.downloads @jem.name, @jem.version_number %>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h2><i class="fa fa-align-justify"></i><span class="break"></span>Gem Files</h2>
      </div>
      <div class="panel-body">
        <table id="file-list" class="table table-bordered">
          <thead>
            <tr>
              <th>FILE NAME</td>
              <th class="text-center">FILE TYPE</td> 
              <th class="text-center" width="80">DELETE</th>
            </tr>
          </thead>
          <tbody>
            <% @jem.scripts.each do |script| %>
              <tr data-id="<%= script.id %>">
                <td><%= File.basename(script.file.url) %></td>
                <td class="text-center"><%= script.file.file.extension.upcase %></td>
                <td>
                  <%=
                    link_to 'Remove',
                    delete_script_path(script),
                    remote: :true,
                    method: :delete,
                    :data => { confirm: "Are you sure? "},
                    :class => "btn btn-danger btn-xs center-block"
                   %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
        
        <%= form_tag '/create_gem', :method => :post, :remote => :true do %>
          <input type="hidden" name="id" value="<%= @jem.id %>"/>
          <%= submit_tag 'Create Gem', class: "btn btn-primary btn-sm pull-right" %>
        <% end %>
    </div>
  </div>
</div><!--/col-->

<div class="col-md-9">
  <div class="panel panel-default">
    <div class="panel-heading" >
      <h2><i class="fa fa-align-justify"></i><span class="break"></span>Activity</h2>
    </div>
    <div class="panel-body">
      <ul class="dashboard-list" id="activity-list">
        <% @activities.each do |activity| %>
        <li>
          <% if activity.action == "create" %>
            <i class="fa fa-plus" style="color: #36a9e1;"></i> <%= User.find(activity.user_id).name.upcase %> added
          <% elsif activity.action == "destroy" %>
            <i class="fa fa-minus" style="color: #ff5454;"></i> <%= User.find(activity.user_id).name.upcase %> deleted
          <% elsif activity.action == "update" %>
            <i class="fa fa-arrow-up" style="color: #bdea74;"></i> <%= User.find(activity.user_id).name.upcase %> <%= activity.action.sub(/e?$/, "ed") %>
          <% elsif activity.action == "gemify_jem" %>
            <i class="fa fa-heart" style="color: #e84c8a;"></i> <%= User.find(activity.user_id).name.upcase %> gemmed
          <% end %>
          <% if activity.trackable_type == "Jem" %>
            <%= @jem.name %>
          <% else %>
            <%= activity.trackable_name %>
          <% end %>
          <%= time_ago_in_words(activity.created_at) %> ago
        </li>
        <% end %>
        
      </ul>
    </div>
  </div>
</div>

<div id="job-id-container"></div>


<form action="/jems/<%= @jem.id %>/scripts" id="new-script" class="" enctype="multipart/form-data" method="post" style="display:none;">
  <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>" />
  <input name="_method" type="hidden" value="POST" />

  <input name="script[file]" type="file" multiple style="display:none;" />
</form>
